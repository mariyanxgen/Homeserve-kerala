{% extends 'frontend/base.html' %}
{% block title %}Add New Service - Provider Portal{% endblock %}
{% block content %}
<style>
body { 
    background: linear-gradient(135deg, rgba(30, 64, 175, 0.05) 0%, rgba(59, 130, 246, 0.05) 100%),
                url('https://images.unsplash.com/photo-1497366216548-37526070297c?w=1920&q=80') center/cover fixed;
    font-family: 'Times New Roman', Times, serif;
    min-height: 100vh;
}
.provider-portal { max-width: 900px; margin: 0 auto; padding: 30px 20px; }
.nav-tabs { display: flex; gap: 8px; background: white; padding: 12px; border-radius: 12px; margin-bottom: 30px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border: 1px solid #e5e7eb; }
.nav-tabs a { padding: 12px 24px; background: transparent; border-radius: 8px; text-decoration: none; color: #64748b; font-weight: 600; transition: all 0.2s ease; font-size: 0.95em; }
.nav-tabs a:hover { background: #f1f5f9; color: #334155; }
.nav-tabs a.active { background: #1e40af; color: white; }
.section-card { background: white; padding: 32px; border-radius: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: 28px; border: 1px solid #e5e7eb; }
.section-title { font-size: 1.5em; margin-bottom: 24px; color: #1e293b; font-weight: 600; }
.form-group { margin-bottom: 20px; }
.form-group label { display: block; font-weight: 600; color: #1e293b; margin-bottom: 8px; }
.form-group input, .form-group select, .form-group textarea { width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 0.95em; font-family: 'Times New Roman', Times, serif; }
.form-group textarea { min-height: 120px; resize: vertical; }
.form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: #1e40af; box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1); }
.form-group small { display: block; margin-top: 5px; color: #64748b; font-size: 0.85em; }
.checkbox-group { display: flex; align-items: center; gap: 10px; }
.checkbox-group input[type="checkbox"] { width: auto; margin: 0; }
.btn { padding: 12px 28px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; text-decoration: none; display: inline-block; transition: all 0.2s ease; font-size: 0.95em; margin-right: 10px; }
.btn-primary { background: #1e40af; color: white; }
.btn-primary:hover { background: #1e3a8a; }
.btn-secondary { background: #64748b; color: white; }
.btn-secondary:hover { background: #475569; }
.form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
.alert { padding: 12px 16px; border-radius: 8px; margin-bottom: 20px; }
.alert-success { background: #d1fae5; color: #065f46; border-left: 4px solid #059669; }
.alert-error { background: #fee2e2; color: #991b1b; border-left: 4px solid #dc2626; }
</style>

<div class="provider-portal">
    <!-- Navigation Tabs -->
    <div class="nav-tabs">
        <a href="/provider/">Home</a>
        <a href="/provider/services/" class="active">My Services</a>
        <a href="/provider/bookings/">Bookings</a>
        <a href="/provider/earnings/">Earnings</a>
        <a href="/provider/messages/">Messages</a>
        <a href="/provider/calendar/">Calendar</a>
        <a href="/provider/profile/">Profile</a>
        <a href="/provider/reviews/">Reviews</a>
    </div>

    <div class="section-card">
        <h1 class="section-title">{% if is_edit %}Edit Service{% else %}Add New Service{% endif %}</h1>
        
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">{{ message }}</div>
            {% endfor %}
        {% endif %}

        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            
            <div class="form-group">
                <label for="title">Service Title *</label>
                <input type="text" id="title" name="title" required placeholder="e.g., AC Installation & Setup" value="{{ service.title|default:'' }}">
                <small>Enter a clear and descriptive service name</small>
            </div>

            <div class="form-group">
                <label for="category">Category *</label>
                <select id="category" name="category" required>
                    <option value="">Select a category</option>
                    {% for cat in categories %}
                        <option value="{{ cat.id }}" {% if service and service.category.id == cat.id %}selected{% endif %}>{{ cat.name }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label for="description">Description *</label>
                <textarea id="description" name="description" required placeholder="Describe what's included in this service, your expertise, tools used, etc.">{{ service.description|default:'' }}</textarea>
                <small>Provide detailed information about your service</small>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="pricing_type">Pricing Type *</label>
                    <select id="pricing_type" name="pricing_type" required>
                        <option value="fixed" {% if service and service.pricing_type == 'fixed' %}selected{% endif %}>Fixed Price</option>
                        <option value="hourly" {% if service and service.pricing_type == 'hourly' %}selected{% endif %}>Hourly Rate</option>
                        <option value="negotiable" {% if service and service.pricing_type == 'negotiable' %}selected{% endif %}>Negotiable</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="price">Price (â‚¹) *</label>
                    <input type="number" id="price" name="price" required min="0" step="0.01" placeholder="800" value="{{ service.price|default:'' }}">
                    <small>Base price for the service</small>
                </div>
            </div>

            <div class="form-group">
                <label for="duration_minutes">Duration (minutes) *</label>
                <input type="number" id="duration_minutes" name="duration_minutes" value="{{ service.duration_minutes|default:'60' }}" required min="15" step="15">
                <small>Estimated time to complete the service</small>
            </div>

            <div class="form-group">
                <label for="service_image">Service Image{% if service and service.service_image %} (Current: {{ service.service_image.name }}){% endif %}</label>
                <input type="file" id="service_image" name="service_image" accept="image/*">
                <small>Upload an image of your service{% if is_edit %} (leave empty to keep current image){% endif %}</small>
            </div>

            <div class="form-group">
                <div class="checkbox-group">
                    <input type="checkbox" id="is_emergency_available" name="is_emergency_available" {% if service and service.is_emergency_available %}checked{% endif %}>
                    <label for="is_emergency_available" style="margin: 0;">Available for Emergency Requests</label>
                </div>
                <small>Check if you can provide this service on short notice for emergencies</small>
            </div>

            <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #e5e7eb;">
                <button type="submit" class="btn btn-primary">{% if is_edit %}Update Service{% else %}Add Service{% endif %}</button>
                <a href="/provider/services/" class="btn btn-secondary">Cancel</a>
            </div>
        </form>
    </div>
</div>

{% endblock %}
